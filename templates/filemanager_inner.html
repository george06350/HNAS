<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>文件管理器</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>body { background:#f4f8fc; }</style>
</head>
<body>
<div class="container-fluid mt-2">
    <form action="/filemanager_inner/upload" method="post" enctype="multipart/form-data" class="mb-2" target="upload_frame">
        <input type="file" name="file" required>
        <input type="hidden" name="cur_path" value="{{ cur_path }}">
        <button class="btn btn-sm btn-success">上传文件</button>
        <iframe style="display:none" name="upload_frame"></iframe>
    </form>
    <table class="table table-striped table-sm">
        <tr>
            <th>名称</th>
            <th>类型</th>
            <th>操作</th>
        </tr>
        {% if cur_path %}
        <tr>
            <td colspan="3">
                <a href="javascript:window.parent.reloadFileManager('{{ cur_path.rsplit('/', 1)[0] }}')">⬅ 返回上级</a>
            </td>
        </tr>
        {% endif %}
        {% for entry in entries %}
        <tr>
            <td>{{ entry.name }}</td>
            <td>{{ "文件夹" if entry.is_dir else "文件" }}</td>
            <td>
                {% if entry.is_dir %}
                <a href="javascript:window.parent.reloadFileManager('{{ entry.rel_path }}')" class="btn btn-sm btn-primary">进入</a>
                {% else %}
                <a href="/filemanager_inner/download/{{ entry.rel_path }}" class="btn btn-sm btn-info" target="_blank">下载</a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
</div>
</body>
</html>